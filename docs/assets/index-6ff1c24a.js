(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))o(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const l of t.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function d(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function o(e){if(e.ep)return;e.ep=!0;const t=d(e);fetch(e.href,t)}})();const U=""+new URL("A-c5f6de80.png",import.meta.url).href,W=""+new URL("B-69c7dc64.png",import.meta.url).href;async function b(){const c=document.getElementById("a"),n=new Image;n.src=U,await n.decode(),c.width=n.width,c.height=n.height;const d=c.getContext("2d");if(d===null)return;d.drawImage(n,0,0);const o=document.getElementById("b"),e=new Image;e.src=W,await e.decode(),o.width=n.width,o.height=n.height;const t=o.getContext("2d");if(t===null)return;t.drawImage(e,0,0);const l=d.getImageData(0,0,c.width,c.height),v=cv.matFromImageData(l),V=t.getImageData(0,0,o.width,o.height),g=cv.matFromImageData(V),L=new cv.ORB,D=new cv.KeyPointVector,P=new cv.KeyPointVector,y=new cv.Mat,B=new cv.Mat;L.detectAndCompute(v,new cv.Mat,D,y),L.detectAndCompute(g,new cv.Mat,P,B);const F=new cv.BFMatcher(cv.NORM_HAMMING,!0),m=new cv.DMatchVector;F.match(y,B,m);let u=0;for(let a=0;a<m.size();a++)u+=m.get(a).distance;u/=m.size();const K=32*8;u/=K,console.log("matchScore",u);const C=document.getElementById("score");C!==null&&(C.innerText=u.toFixed(3));let N=new cv.Mat;cv.absdiff(g,v,N);const S=new cv.Mat;cv.cvtColor(N,S,cv.COLOR_BGR2GRAY);const z=1,E=new cv.Mat;cv.threshold(S,E,z,255,cv.THRESH_BINARY),cv.imshow("mask",E);const T=cv.Mat.ones(5,5,cv.CV_8U),M=new cv.Mat;let r=document.getElementById("dilateIterations"),A=r!=null?parseInt(r.value):2;cv.dilate(E,M,T,new cv.Point(-1,-1),A,cv.BORDER_CONSTANT,cv.morphologyDefaultBorderValue()),cv.imshow("dilate",M);const R=new cv.Mat;r=document.getElementById("erodeIterations"),A=r!=null?parseInt(r.value):2,cv.erode(M,R,T,new cv.Point(-1,-1),A,cv.BORDER_CONSTANT,cv.morphologyDefaultBorderValue()),cv.imshow("erode",R);const O=new cv.MatVector,H=new cv.Mat;cv.findContours(R,O,H,cv.RETR_EXTERNAL,cv.CHAIN_APPROX_SIMPLE);try{const a=[];for(let i=0;i<O.size();i++)a.push(O.get(i));let f=new cv.Mat,X=new cv.Mat,k=-1;cv.addWeighted(g,.5,v,.5,0,f,k),r=document.getElementById("contourArea");const G=r!=null?parseInt(r.value):100;for(const i of a)if(cv.contourArea(i)>G){const s=cv.boundingRect(i),x=new cv.Point(s.x,s.y),_=new cv.Point(s.x+s.width,s.y+s.height);cv.rectangle(f,x,_,new cv.Scalar(0,0,255),2),cv.rectangle(f,x,_,new cv.Scalar(0,0,255),2)}cv.imshow("diff",f)}catch(a){console.error(a)}console.log("moin"),v.delete(),g.delete(),D.delete(),P.delete(),y.delete(),B.delete(),m.delete()}cv.getBuildInformation?b():(console.log("WASM"),cv.onRuntimeInitialized=()=>{b()});const I=document.getElementById("syncIterations"),p=document.getElementById("dilateIterations"),w=document.getElementById("erodeIterations");I.addEventListener("change",()=>{I.checked&&(w.value=p.value)});p.addEventListener("input",()=>{I.checked&&(w.value=p.value)});w.addEventListener("input",()=>{I.checked&&(p.value=w.value)});let h;[document.getElementById("dilateIterations"),document.getElementById("erodeIterations"),document.getElementById("contourArea")].forEach(c=>{c!==null&&c.addEventListener("input",()=>{h!==void 0&&clearTimeout(h),h=setTimeout(()=>{b(),h=void 0},700)})});
